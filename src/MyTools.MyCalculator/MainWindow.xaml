<Window x:Class="MyTools.MyCalculator.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="My Calculator"
        Height="{DynamicResource AppWindowHeight}"
        Width="{DynamicResource AppWindowWidth}"
        MinHeight="{DynamicResource AppWindowHeight}"
        MinWidth="{DynamicResource AppWindowWidth}"
        ResizeMode="NoResize"
        SizeToContent="Manual"
        WindowStartupLocation="CenterScreen"
        Background="{DynamicResource WindowBackgroundBrush}">
    <DockPanel LastChildFill="False">
        <DockPanel DockPanel.Dock="Top">
            <Menu DockPanel.Dock="Top">
                <MenuItem Header="_File">
                    <MenuItem Header="E_xit" Click="Exit_Click"/>
                </MenuItem>
                <MenuItem Header="_Edit">
                    <MenuItem Header="_Clear" Click="Clear_Click"/>
                </MenuItem>
                <MenuItem Header="_View">
                    <MenuItem Header="_Settings" Click="OpenSettings_Click"/>
                    <MenuItem Header="_History" Click="OpenHistory_Click"/>
                    <Separator/>
                    <MenuItem Header="_Mode">
                        <MenuItem x:Name="ModeGeneralItem" Header="_General" IsCheckable="True" Click="Mode_General_Click"/>
                        <MenuItem x:Name="ModeScientificItem" Header="_Scientific" IsCheckable="True" Click="Mode_Scientific_Click"/>
                        <MenuItem x:Name="ModeFinancialItem" Header="_Financial" IsCheckable="True" Click="Mode_Financial_Click"/>
                    </MenuItem>
                </MenuItem>
                <MenuItem Header="_Help">
                    <MenuItem Header="_About" Click="About_Click"/>
                </MenuItem>
            </Menu>
            <ToolBarTray DockPanel.Dock="Top">
                <ToolBar>
                    <Button Content="Settings" Click="OpenSettings_Click"/>
                    <Separator/>
                    <Button Content="Clear" Click="Clear_Click"/>
                    <Button Content="= Evaluate" Click="Evaluate_Click"/>
                    <Separator/>
                    <Button Content="History" Click="OpenHistory_Click"/>
                </ToolBar>
            </ToolBarTray>
        </DockPanel>

    <!-- Removed obsolete status bar formula display -->

    <!-- Main content with overall scale -->
    <Grid DockPanel.Dock="Top">
            <Grid.LayoutTransform>
                <ScaleTransform ScaleX="{DynamicResource AppScale}" ScaleY="{DynamicResource AppScale}"/>
            </Grid.LayoutTransform>

            <StackPanel Margin="12" Orientation="Vertical">
                <!-- Physical calculator screen look -->
                <Border Background="{DynamicResource CalculatorBezelBrush}" CornerRadius="8" Padding="8" Margin="0,0,0,8">
                    <Border Background="{DynamicResource CalculatorScreenBrush}" CornerRadius="4" Padding="6">
                        <StackPanel>
                            <TextBlock x:Name="ScreenModeLabel" Text="Calculator" Foreground="#CCFFFFFF" FontSize="12" HorizontalAlignment="Right"/>
                            <TextBox x:Name="FormulaInput"
                                     FontSize="{DynamicResource FormulaFontSize}"
                                     MinHeight="44"
                                     VerticalContentAlignment="Center"
                                     KeyDown="FormulaInput_KeyDown"
                                     Background="Transparent"
                                     BorderThickness="0"
                                     Foreground="{DynamicResource ScreenTextBrush}"/>
                            <TextBlock x:Name="ResultText" FontSize="{DynamicResource ResultFontSize}" Margin="0,4,0,0" Foreground="{DynamicResource ScreenTextBrush}">
                                <TextBlock.Effect>
                                    <DropShadowEffect Color="#33000000" Opacity="0.5" BlurRadius="6" ShadowDepth="0"/>
                                </TextBlock.Effect>
                            </TextBlock>
                        </StackPanel>
                    </Border>
                </Border>

                <!-- Mode-specific pads -->
                <StackPanel x:Name="GeneralPad" Orientation="Vertical">
                    <UniformGrid Rows="5" Columns="4" HorizontalAlignment="Stretch" VerticalAlignment="Top" Margin="0,8,0,0">
                        <Button Content="7" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="8" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="9" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="÷" Click="PadButton_Click" Style="{DynamicResource OpPadButton}"/>

                        <Button Content="4" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="5" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="6" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="×" Click="PadButton_Click" Style="{DynamicResource OpPadButton}"/>

                        <Button Content="1" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="2" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="3" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="-" Click="PadButton_Click" Style="{DynamicResource OpPadButton}"/>

                        <Button Content="0" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="." Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="(" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content=")" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>

                        <Button Content="C" Click="PadButton_Click" Style="{DynamicResource WarnPadButton}"/>
                        <Button Content="⌫" Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                        <Button Content="+" Click="PadButton_Click" Style="{DynamicResource OpPadButton}"/>
                        <Button Content="=" Click="PadButton_Click" Style="{DynamicResource OpPadButton}"/>
                    </UniformGrid>
                </StackPanel>

                <StackPanel x:Name="SciPad" Orientation="Vertical" Visibility="Collapsed" Margin="0,8,0,0">
                    <UniformGrid Columns="6">
                        <Button Content="sin(" Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                        <Button Content="cos(" Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                        <Button Content="tan(" Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                        <Button Content="ln(" Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                        <Button Content="log(" Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                        <Button Content="sqrt(" Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>

                        <Button Content="^" Click="PadButton_Click" Style="{DynamicResource OpPadButton}"/>
                        <Button Content="min(" Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                        <Button Content="max(" Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                        <Button Content="pi" Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                        <Button Content="e" Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                        <Button Content="," Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                    </UniformGrid>
                    <!-- Use a thin rectangle instead of Separator to avoid extra vertical space -->
                    <Rectangle Height="1" Fill="#33000000" Margin="{DynamicResource SciSeparatorMargin}"/>
                    <UniformGrid Rows="5" Columns="4" HorizontalAlignment="Stretch" VerticalAlignment="Top" Margin="{DynamicResource SciNumericPadMargin}">
                        <Button Content="7" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="8" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="9" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="÷" Click="PadButton_Click" Style="{DynamicResource OpPadButton}"/>
                        <Button Content="4" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="5" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="6" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="×" Click="PadButton_Click" Style="{DynamicResource OpPadButton}"/>
                        <Button Content="1" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="2" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="3" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="-" Click="PadButton_Click" Style="{DynamicResource OpPadButton}"/>
                        <Button Content="0" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="." Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="(" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content=")" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="C" Click="PadButton_Click" Style="{DynamicResource WarnPadButton}"/>
                        <Button Content="⌫" Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                        <Button Content="+" Click="PadButton_Click" Style="{DynamicResource OpPadButton}"/>
                        <Button Content="=" Click="PadButton_Click" Style="{DynamicResource OpPadButton}"/>
                    </UniformGrid>
                </StackPanel>

                <StackPanel x:Name="FinPad" Orientation="Vertical" Visibility="Collapsed" Margin="0,8,0,0">
                    <UniformGrid Columns="5">
                        <Button Content="pmt(" Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                        <Button Content="pv(" Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                        <Button Content="fv(" Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                        <Button Content="nper(" Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                        <Button Content="," Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                    </UniformGrid>
                    <!-- Use a thin rectangle instead of Separator to avoid extra vertical space -->
                    <Rectangle Height="1" Fill="#33000000" Margin="0,8,0,8"/>
                    <UniformGrid Rows="5" Columns="4" HorizontalAlignment="Stretch" VerticalAlignment="Top">
                        <Button Content="7" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="8" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="9" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="÷" Click="PadButton_Click" Style="{DynamicResource OpPadButton}"/>
                        <Button Content="4" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="5" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="6" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="×" Click="PadButton_Click" Style="{DynamicResource OpPadButton}"/>
                        <Button Content="1" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="2" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="3" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="-" Click="PadButton_Click" Style="{DynamicResource OpPadButton}"/>
                        <Button Content="0" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="." Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="(" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content=")" Click="PadButton_Click" Style="{DynamicResource SquarePadButton}"/>
                        <Button Content="C" Click="PadButton_Click" Style="{DynamicResource WarnPadButton}"/>
                        <Button Content="⌫" Click="PadButton_Click" Style="{DynamicResource FuncPadButton}"/>
                        <Button Content="+" Click="PadButton_Click" Style="{DynamicResource OpPadButton}"/>
                        <Button Content="=" Click="PadButton_Click" Style="{DynamicResource OpPadButton}"/>
                    </UniformGrid>
                </StackPanel>

            </StackPanel>
        </Grid>
    </DockPanel>
</Window>
